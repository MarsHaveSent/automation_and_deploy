# Sales Automation Project

![Python Version](https://img.shields.io/badge/python-3.8%2B-blue)

Проект для автоматизации обработки и анализа данных о продажах. Система позволяет загружать данные из CSV-файлов в базу данных, выполнять аналитические запросы и генерировать отчеты.

## Структура проекта

```
SALES_AUTOMATION_PJ/
├── img/ # Изображения и скриншоты БД и примера автоматизации в Windows Scheduler
├── logs/ # Лог-файлы работы системы
├── src/ # Основной исходный код проекта
│ ├── data/ # Папка для хранения данных
│ │ └── YYYY-MM-DD/ # Папки с данными по датам
│ │ ├── 1_1.csv # Примеры CSV файлов
│ │ ├── 1_2.csv
│ │ └── ... # и т.д.
│ ├── scripts/ # Вспомогательные скрипты
│ │ ├── init_db.py # Инициализация базы данных
│ │ ├── load_data.py # Загрузка данных из CSV
│ └── sql/ # SQL скрипты и модули
│   ├── create_tables.sql # SQL для создания таблиц
│ ├── init.py # Пакетный инициализатор
│ ├── config.py # Конфигурация проекта
│ ├── generate_sales.py # Генератор тестовых данных
│ ├── loader.py # Основной загрузчик данных
│ ├── simple_database.py # Упрощенный модуль работы с БД
├── .env.example # Пример файла окружения
├── .gitignore # Исключения для Git
├── README.md # Этот файл
├── requirements.txt # Зависимости Python
├── windows_genearte.bat-example # Пример BAT скрипта
└── windows_load.bat-example # Пример BAT скрипта
```

## Предварительные требования

- Python 3.8 или выше
- PostgreSQL 

## Установка и настройка

### 1. Клонирование и настройка окружения

```bash
# Создайте виртуальное окружение
python -m venv venv

# Активируйте виртуальное окружение
# На Windows:
venv\Scripts\activate
# На macOS/Linux:
source venv/bin/activate

# Установите зависимости
pip install -r requirements.txt
```

### 2. Настройка базы данных

Создайте базу данных в PostgreSQL:

```sql
CREATE DATABASE sales_automation;
```

### 3. Конфигурация

Создайте файл `.env` на основе `.env.example`:

```bash
# Скопируйте пример конфигурации
cp .env.example .env
# Отредактируйте .env файл, указав свои настройки
```

### 4. Инициализация базы данных

```bash
# Создание таблиц в базе данных
python src/scripts/init_db.py

# Или выполните вручную при непредвиденных проблемах
```

## Использование

### Загрузка данных

1. Поместите CSV файлы в папку `src/data/YYYY-MM-DD/` (где YYYY-MM-DD - дата загрузки)
2. Запустите скрипт загрузки:

```bash
# Основной загрузчик
python src/loader.py

# Или используйте скрипт напрямую
python src/scripts/load_data.py --date YYYY-MM-DD --verbose
```

### Генерация тестовых данных

```bash
# Сгенерируйте тестовые данные
python generate_sales.py  --stores 5
```

## Файлы данных

CSV файлы должны иметь следующую структуру:

- `1_1.csv`, `2_1.csv` и т.д. - основные данные о продажах

Формат именования: `{shop_num}_{cash_num}.csv`

## Автоматизация с помощью Windows Scheduler

### Cоздание чеков

1. Cоздать в корне проекта файл с расширением .bat 
    (можно воспользоваться примером файла windows_genearte.bat-example)
2. Протестировать в первый раз через консоль:
```bash
./windows_genearte.bat
```
3. Создать через Планировщик Задач - задачу (установить триггер,выбрать исполняемый файл в корне проекта)

### Загрузка в БД

1. Cоздать в корне проекта файл с расширением .bat 
    (можно воспользоваться примером файла windows_load.bat-example)
2. Протестировать в первый раз через консоль:
```bash
./windows_load.bat
```
3. Создать через Планировщик Задач - задачу (установить триггер,выбрать исполняемый файл в корне проекта)


## Разработка

### Добавление новых типов данных

1. Добавьте соответствующую таблицу в `sql/create_tables.sql`
2. Создайте или обновите парсер в `loader.py`
3. Протестируйте загрузку данных

## Устранение неполадок

### Проблемы с подключением к БД

1. Проверьте корректность `DATABASE_URL` в `.env`
2. Убедитесь, что PostgreSQL запущен
3. Проверьте права доступа пользователя к базе данных

### Проблемы с загрузкой CSV

1. Проверьте кодировку файлов (должна быть UTF-8)
2. Убедитесь в правильности разделителей (запятая)
3. Проверьте соответствие столбцов ожидаемой структуре
