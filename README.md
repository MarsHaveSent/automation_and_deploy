# Sales Automation Project

![Python Version](https://img.shields.io/badge/python-3.8%2B-blue)

Проект для автоматизации обработки и анализа данных о продажах. Система позволяет загружать данные из CSV-файлов в базу данных, выполнять аналитические запросы и генерировать отчеты.

## Структура проекта

```
SALES_AUTOMATION_PJ/
├── src/                             # Основной код проекта
│   └── data/2026-01-13/            # Исходные данные (CSV файлы)
│       ├── 1_1.csv
│       ├── 1_2.csv
│       └── ... (остальные файлы)
├── scripts/                         # Скрипты для работы с БД
│   ├── init_db.py                  # Инициализация базы данных
│   ├── load_data.py                # Загрузка данных из CSV
│   └── __pycache__/
├── sql/                            # SQL скрипты
│   └── create_tables.sql           Создание таблиц
├── venv/                           # Виртуальное окружение Python (не включено в git)
├── .env                            # Переменные окружения (не включено в git)
├── .env.example                    # Пример файла окружения
├── .gitignore                      # Исключения для Git
├── README.md                       # Этот файл
├── requirements.txt                # Зависимости Python
├── config.py                       # Конфигурация приложения
├── loader.py                       # Основной загрузчик данных
├── generate_sales.py               # Генератор тестовых данных
├── simple_database.py              # Упрощенный модуль работы с БД
└── sales_automation_pj.code-workspace # Конфигурация VS Code
```

## Предварительные требования

- Python 3.8 или выше
- PostgreSQL 

## Установка и настройка

### 1. Клонирование и настройка окружения

```bash
# Создайте виртуальное окружение
python -m venv venv

# Активируйте виртуальное окружение
# На Windows:
venv\Scripts\activate
# На macOS/Linux:
source venv/bin/activate

# Установите зависимости
pip install -r requirements.txt
```

### 2. Настройка базы данных

Создайте базу данных в PostgreSQL:

```sql
CREATE DATABASE sales_automation;
```

### 3. Конфигурация

Создайте файл `.env` на основе `.env.example`:

```bash
# Скопируйте пример конфигурации
cp .env.example .env

# Отредактируйте .env файл, указав свои настройки:
DATABASE_URL=postgresql://username:password@localhost:5432/sales_automation
```

### 4. Инициализация базы данных

```bash
# Создание таблиц в базе данных
python src/scripts/init_db.py

# Или выполните вручную при непредвиденных проблемах
```

## Использование

### Загрузка данных

1. Поместите CSV файлы в папку `src/data/YYYY-MM-DD/` (где YYYY-MM-DD - дата загрузки)
2. Запустите скрипт загрузки:

```bash
# Основной загрузчик
python src/loader.py

# Или используйте скрипт напрямую
python src/scripts/load_data.py --date YYYY-MM-DD --verbose
```

### Генерация тестовых данных

```bash
# Сгенерируйте тестовые данные
python generate_sales.py  --stores 5
```

## Файлы данных

CSV файлы должны иметь следующую структуру:

- `1_1.csv`, `2_1.csv` и т.д. - основные данные о продажах

Формат именования: `{shop_num}_{cash_num}.csv`

## Разработка

### Добавление новых типов данных

1. Добавьте соответствующую таблицу в `sql/create_tables.sql`
2. Создайте или обновите парсер в `loader.py`
3. Протестируйте загрузку данных

## Устранение неполадок

### Проблемы с подключением к БД

1. Проверьте корректность `DATABASE_URL` в `.env`
2. Убедитесь, что PostgreSQL запущен
3. Проверьте права доступа пользователя к базе данных

### Проблемы с загрузкой CSV

1. Проверьте кодировку файлов (должна быть UTF-8)
2. Убедитесь в правильности разделителей (запятая)
3. Проверьте соответствие столбцов ожидаемой структуре